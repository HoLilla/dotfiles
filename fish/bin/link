#!/usr/bin/env bash

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" >/dev/null && pwd)"
CONFIG_DIR="$HOME/.config/fish"
FUNCTION_DIR="functions"

mkdir -p "$CONFIG_DIR"

for FILENAME in config.fish fishfile; do
  rm -f "$CONFIG_DIR/$FILENAME"
  ln -s "$SCRIPT_DIR/../$FILENAME" "$CONFIG_DIR/$FILENAME"
done

for FUNCTION_FILE_SOURCE in "$SCRIPT_DIR/../$FUNCTION_DIR"/*.fish; do
  FUNCTION_FILE_DESTINATION="$CONFIG_DIR/$FUNCTION_DIR/$(basename "$FUNCTION_FILE_SOURCE")"

  rm -f "$FUNCTION_FILE_DESTINATION"
  ln -s "$FUNCTION_FILE_SOURCE" "$FUNCTION_FILE_DESTINATION"
done
