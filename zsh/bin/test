#!/usr/bin/env bats


@test "there are no compaudit issues" {
  run zsh -c "autoload -U compaudit && compaudit"

  [ "$status" -eq 0 ]
}

@test "zsh is installed and runs" {
  run zsh --login --interactive -c "echo hello"

  [ "$status" -eq 0 ]
  [ "${lines[0]}" = "hello" ]
}

@test "whatismyip gets an external ip" {
  run zsh --login --interactive -c "whatismyip"

  [[ "${lines[0]}" =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]
  [ "$status" -eq 0 ]
}

@test "ll lists directories" {
  run zsh --login --interactive -c "ll"

  [ "$status" -eq 0 ]
}

@test "I can access hub via git" {
  run zsh --login --interactive -c "git | grep pull-request"

  [ "$status" -eq 0 ]
}

@test "use java can change the version of java to use" {
  run zsh --login --interactive -c "use_java 1.8 && java -version"

  [ "$status" -eq 0 ]
  [[ "${lines[0]}" =~ \"1\.8 ]]
}

@test "Less is more" {
  run zsh --login -c "more"

  [ "$status" -eq 0 ]
  [[ "${lines[0]}" =~ less ]]
}
